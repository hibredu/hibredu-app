version: '3.7'
services: 
    app:
        image: node:12-alpine
        ports:
            - '80:3000'
        depends_on: 
            - database
        command: sh -c "cd /usr/app && npm install && npm run dev"
        volumes: 
            - ./app:/usr/app
            - ./app/node_modules:/usr/app/node_modules
    database:
        restart: always
        image: mysql:5.7
        ports:
            - "3307:3306"
        environment:
            MYSQL_USER: 'user_hibredu'
            MYSQL_PASSWORD: '123456'
            MYSQL_ROOT_PASSWORD: '123456'
            MYSQL_DATABASE: 'hibredu_db'
        volumes:
            - appdbdata:/var/lib/mysql
            - ./docker/sql/recipesDb:/docker-entrypoint-initdb.d
volumes:
    appdbdata:
        driver: local

networks:
    default: